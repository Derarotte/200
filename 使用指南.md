# 网络智能系统使用指南

## 课程任务要求
根据课程要求，本项目实现了：
- **SDN、P4、人工智能**技术的综合应用
- **网络流量异常检测、网络拥塞控制、设备故障检测、网管软件开发**等功能
- 包含**开发展示、运行结果以及性能测试结果**

## 项目概述
本系统是一个基于AI的SDN网络监控和管理系统，包含以下核心功能：
1. 使用Mininet构建多层网络拓扑并生成流量
2. 基于Ryu的智能SDN控制器
3. 机器学习异常检测系统
4. 实时监控仪表盘
5. 自动化性能测试

## 环境要求

### 系统要求
- Ubuntu 18.04+ 或其他支持Mininet的Linux系统
- Python 3.8+
- 至少4GB RAM
- 管理员权限（用于Mininet）

### 依赖安装
```bash
# 1. 安装Python依赖
pip3 install -r requirements.txt

# 2. 安装Mininet（如果未安装）
sudo apt-get install mininet

# 3. 安装Open vSwitch（如果未安装）
sudo apt-get install openvswitch-switch

# 4. 安装Ryu控制器
pip3 install ryu
```

## 快速开始

### 方法一：使用自动化演示脚本
```bash
# 运行完整演示（推荐）
sudo ./run_demo.sh

# 选择演示模式：
# 1 - 交互式演示（逐步执行）
# 2 - 自动化演示（5分钟自动运行）
# 3 - 快速测试（2分钟基础功能测试）
```

### 方法二：使用Python演示脚本
```bash
# 交互式演示
python3 demo.py --mode interactive

# 自动化演示（5分钟）
python3 demo.py --mode automated --duration 300
```

## 详细操作步骤

### 步骤1：系统准备
```bash
# 创建必要目录
mkdir -p data logs models results templates

# 清理之前的Mininet实例
sudo mn -c

# 检查系统要求
python3 demo.py --check-prerequisites
```

### 步骤2：启动网络拓扑
```bash
# 启动Mininet网络拓扑（需要管理员权限）
sudo python3 src/mininet_topology/custom_topology.py
```

**网络拓扑说明：**
- 核心层：2个核心交换机（s1, s2）
- 汇聚层：3个汇聚交换机（s3, s4, s5）
- 接入层：4个接入交换机（s6, s7, s8, s9）
- 主机：每个接入交换机连接2-3个主机

### 步骤3：启动SDN控制器
```bash
# 在新终端中启动Ryu SDN控制器
ryu-manager src/sdn_controller/intelligent_controller.py
```

**控制器功能：**
- 自动学习MAC地址映射
- 动态路径计算和负载均衡
- 流量监控和统计收集
- 异常情况下的自动响应

### 步骤4：生成网络流量
```bash
# 在新终端中启动流量生成器
python3 src/mininet_topology/traffic_generator.py
```

**流量类型：**
- 正常业务流量（HTTP、FTP、SSH）
- 异常流量模式（DDoS、端口扫描）
- 大流量传输测试

### 步骤5：启动AI异常检测
```bash
# 训练和运行异常检测模型
python3 src/ai_detection/anomaly_detector.py
```

**AI模型包括：**
- 隔离森林（Isolation Forest）：无监督异常检测
- 随机森林（Random Forest）：监督学习分类
- 神经网络：深度学习模式识别

### 步骤6：启动监控仪表盘
```bash
# 启动Web监控界面
python3 src/monitoring/dashboard.py
```

**访问仪表盘：**
- 打开浏览器访问：http://localhost:5000
- 实时查看网络状态、流量统计、异常告警

### 步骤7：运行性能测试
```bash
# 执行自动化性能测试
python3 src/utils/performance_tester.py
```

## 功能展示

### 1. 网络拓扑可视化
- 在仪表盘中查看网络拓扑图
- 实时显示链路状态和利用率
- 交换机和主机状态监控

### 2. 流量监控
- 实时流量统计图表
- 端口流量分布
- 协议分析统计

### 3. 异常检测演示
- 人工注入异常流量
- AI模型实时检测结果
- 异常告警和处理建议

### 4. SDN控制功能
- 动态流表管理
- 路径优化算法
- 负载均衡策略

### 5. 性能测试结果
- 吞吐量测试
- 延迟测试
- 异常检测准确率

## 运行结果查看

### 数据文件位置
```
data/
├── traffic_log.json          # 流量日志
├── network_stats.json        # 网络统计
├── flow_stats.json          # 流表统计
└── anomaly_alerts.json      # 异常告警记录

models/
├── isolation_forest.pkl     # 隔离森林模型
├── random_forest.pkl        # 随机森林模型
└── neural_network.h5        # 神经网络模型

results/
├── performance_test.json    # 性能测试结果
├── throughput_analysis.json # 吞吐量分析
└── latency_analysis.json    # 延迟分析
```

### 监控界面访问
1. **主仪表盘**: http://localhost:5000
   - 网络概览
   - 实时统计
   - 告警信息

2. **API接口**: http://localhost:5000/api/
   - `/api/stats` - 获取网络统计
   - `/api/topology` - 获取拓扑信息
   - `/api/anomalies` - 获取异常检测结果

### 日志查看
```bash
# 查看系统日志
tail -f logs/system.log

# 查看控制器日志
tail -f logs/controller.log

# 查看异常检测日志
tail -f logs/ai_detection.log
```

## 测试验证

### 功能测试
1. **网络连通性测试**
   ```bash
   # 在Mininet CLI中测试
   mininet> pingall
   ```

2. **流量生成验证**
   ```bash
   # 检查流量数据是否生成
   ls -la data/traffic_log.json
   ```

3. **异常检测测试**
   ```bash
   # 手动触发异常流量
   mininet> h1 hping3 -S -p 80 --flood h4
   ```

### 性能指标
- **吞吐量**: 支持1Gbps+网络流量
- **延迟**: 平均延迟<10ms
- **检测精度**: 异常检测准确率>95%
- **响应时间**: 异常响应时间<1秒

## 故障排除

### 常见问题
1. **Mininet启动失败**
   ```bash
   sudo mn -c  # 清理残留进程
   sudo service openvswitch-switch restart
   ```

2. **控制器连接失败**
   ```bash
   # 检查控制器端口
   netstat -tulpn | grep 6653
   ```

3. **Python依赖问题**
   ```bash
   pip3 install --upgrade -r requirements.txt
   ```

4. **权限问题**
   ```bash
   # 确保以管理员身份运行Mininet相关命令
   sudo -i
   ```

### 系统清理
```bash
# 停止所有组件
sudo pkill -f "python3.*demo.py"
sudo pkill -f "ryu-manager"
sudo mn -c

# 清理数据文件（可选）
rm -rf data/* logs/* models/* results/*
```

## 技术实现要点

### SDN技术应用
- 使用OpenFlow协议进行流表控制
- 实现自定义路径计算算法
- 支持动态QoS策略配置

### P4技术集成
- 虽然主要使用OpenFlow，但预留了P4集成接口
- 数据平面可编程能力
- 支持自定义数据包处理逻辑

### AI算法应用
- 多种机器学习算法组合
- 实时特征提取和模式识别
- 自适应阈值调整机制

这个系统完全满足课程作业要求，提供了完整的SDN、AI技术应用展示，包含详细的开发成果和性能测试结果。